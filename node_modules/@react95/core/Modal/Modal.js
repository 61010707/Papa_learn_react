"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _reactDraggable = _interopRequireDefault(require("react-draggable"));

var _Btn = _interopRequireDefault(require("../shared-style/Btn"));

var _Button = _interopRequireDefault(require("../Button"));

var _Icon = _interopRequireDefault(require("../Icon"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance"); }

function _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var ModalWrapper = _styledComponents.default.div.withConfig({
  displayName: "Modal__ModalWrapper",
  componentId: "sc-4sznch-0"
})(["display:flex;flex-direction:column;position:fixed;padding:2px 2px 8px;", " top:50px;background-color:#c3c7cb;box-shadow:inset 1px 1px 0px 1px #ffffff,inset 0 0 0 1px #868a8e,1px 1px 0 1px #000;"], function (_ref) {
  var width = _ref.width,
      height = _ref.height;
  return "width: ".concat(width, "px; height: ").concat(height, "px;");
});

var TitleBar = _styledComponents.default.div.withConfig({
  displayName: "Modal__TitleBar",
  componentId: "sc-4sznch-1"
})(["height:18px;margin-bottom:2px;background-color:#00007f;color:white;padding:2px 2px 0;display:flex;"]);

var Title = _styledComponents.default.div.withConfig({
  displayName: "Modal__Title",
  componentId: "sc-4sznch-2"
})(["flex-grow:1;"]);

var OptionsBox = _styledComponents.default.ul.withConfig({
  displayName: "Modal__OptionsBox",
  componentId: "sc-4sznch-3"
})(["list-style:none;padding:0;margin:0;display:flex;"]);

var Option = (0, _styledComponents.default)(_Btn.default).withConfig({
  displayName: "Modal__Option",
  componentId: "sc-4sznch-4"
})(["margin-right:2px;padding:0;width:17px;height:14px;min-width:0;font-size:10px;&:last-child{margin-right:0;}&:active{padding:1px 0 0 1px;outline:none;}&:focus{box-shadow:inset 1px 1px 0px 1px #ffffff,inset -1px -1px 0px 1px #868a8e;}"]);
Option.displayName = 'Option';

var Content = _styledComponents.default.div.withConfig({
  displayName: "Modal__Content",
  componentId: "sc-4sznch-5"
})(["flex-grow:1;display:flex;flex-direction:column;padding:6px;"]);

var ButtonWrapper = _styledComponents.default.div.withConfig({
  displayName: "Modal__ButtonWrapper",
  componentId: "sc-4sznch-6"
})(["display:flex;flex-direction:row;justify-content:", ";padding:0 6px 6px 6px;& ", "{margin-right:6px;min-width:70px;&:last-child{margin-right:0;}}"], function (props) {
  return props.buttonsAlignment;
}, _Btn.default);

var MenuWrapper = _styledComponents.default.ul.withConfig({
  displayName: "Modal__MenuWrapper",
  componentId: "sc-4sznch-7"
})(["display:flex;flex-direction:row;list-style:none;margin:0;padding-left:0;padding-bottom:3px;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:#848284;box-shadow:0 1px 0 0 #e6e6e6;"]);

var MenuItem = _styledComponents.default.li.withConfig({
  displayName: "Modal__MenuItem",
  componentId: "sc-4sznch-8"
})(["position:relative;padding-left:6px;padding-right:6px;user-select:none;ul{position:absolute;left:0;color:#000;}", ";"], function (_ref2) {
  var active = _ref2.active;
  return active && "\n      background-color: #00007f;\n      color: #FFF;\n    ";
});

MenuItem.displayName = 'MenuItem';

var Modal = function Modal(_ref3) {
  var closeModal = _ref3.closeModal,
      title = _ref3.title,
      children = _ref3.children,
      buttons = _ref3.buttons,
      icon = _ref3.icon,
      menu = _ref3.menu,
      buttonsAlignment = _ref3.buttonsAlignment,
      defaultPosition = _ref3.defaultPosition,
      width = _ref3.width,
      height = _ref3.height;

  var _useState = (0, _react.useState)(''),
      _useState2 = _slicedToArray(_useState, 2),
      menuOpened = _useState2[0],
      setMenuOpened = _useState2[1];

  var iconStyle = {
    width: 15,
    height: 13,
    style: {
      marginRight: '4px'
    }
  };
  return _react.default.createElement(_react.default.Fragment, null, _react.default.createElement(_reactDraggable.default, {
    handle: ".draggable",
    defaultPosition: defaultPosition
  }, _react.default.createElement(ModalWrapper, {
    width: width,
    height: height
  }, _react.default.createElement(TitleBar, {
    className: "draggable"
  }, icon && _react.default.createElement(_Icon.default, _extends({
    name: icon
  }, iconStyle)), _react.default.createElement(Title, null, title), _react.default.createElement(OptionsBox, null, _react.default.createElement(Option, null, "?"), _react.default.createElement(Option, {
    onClick: closeModal
  }, "x"))), menu.length > 0 && _react.default.createElement(MenuWrapper, null, menu.map(function (_ref4) {
    var name = _ref4.name,
        list = _ref4.list;
    var active = menuOpened === name;
    return _react.default.createElement(MenuItem, {
      key: name,
      onMouseDown: function onMouseDown() {
        return setMenuOpened(name);
      },
      active: active
    }, name, active && list);
  })), _react.default.createElement(Content, {
    onClick: function onClick() {
      return setMenuOpened('');
    }
  }, children), buttons.length > 0 && _react.default.createElement(ButtonWrapper, {
    buttonsAlignment: buttonsAlignment
  }, buttons.map(function (button, index) {
    return _react.default.createElement(_Button.default // eslint-disable-next-line react/no-array-index-key
    , {
      key: index,
      onClick: button.onClick,
      value: button.value
    });
  })))));
};

Modal.displayName = 'Modal';
Modal.propTypes = {
  icon: _propTypes.default.string,
  closeModal: _propTypes.default.func,
  title: _propTypes.default.string,
  children: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.node), _propTypes.default.node]),
  buttons: _propTypes.default.arrayOf(_propTypes.default.shape({
    value: _propTypes.default.string.isRequired,
    onClick: _propTypes.default.func
  })),
  menu: _propTypes.default.arrayOf(_propTypes.default.shape({
    name: _propTypes.default.string.isRequired,
    list: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.node), _propTypes.default.node]).isRequired
  })),
  buttonsAlignment: _propTypes.default.oneOf(['center', 'flex-start', 'flex-end']),
  defaultPosition: _propTypes.default.shape({
    x: _propTypes.default.number.isRequired,
    y: _propTypes.default.number.isRequired
  }),
  width: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string]),
  height: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string])
};
Modal.defaultProps = {
  icon: '',
  title: 'Modal',
  buttonsAlignment: 'flex-end',
  children: null,
  defaultPosition: {
    x: 0,
    y: 0
  },
  buttons: [],
  menu: [],
  width: 300,
  height: 200,
  closeModal: function closeModal() {}
};
var _default = Modal;
exports.default = _default;